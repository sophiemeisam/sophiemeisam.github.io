<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Li√™n Hoa ƒê·ªôn - T·∫≠p Th·ªÉ ƒê·ªông T√¢m</title>
<style>
body{
  background: radial-gradient(circle at top, #1a0a0a, #4a1a1a, #000);
  color:#f1c40f; font-family:"Noto Serif","Times New Roman",serif;
  text-align:center; padding:20px; min-height:100vh;
}
h1{letter-spacing:5px; color:#ffdf7f; text-shadow: 0 0 10px #ff0000;}
.setup-box{ background: rgba(255,255,255,0.1); padding:15px; border-radius:10px; display:inline-block; margin-bottom:20px; border:1px solid #7a0000;}
.box{
  background: linear-gradient(145deg, #2c0e0e, #5a1a1a);
  border:2px solid #c99b2b; border-radius:14px;
  padding:20px; margin:15px auto; max-width:600px;
  box-shadow: 0 0 30px rgba(255,80,40,0.4);
}
.energy-slots { display: flex; justify-content: center; gap: 10px; margin: 20px 0; min-height: 60px; }
.slot { width: 50px; height: 50px; border: 1px dashed #f1c40f; border-radius: 50%; line-height: 50px; font-size: 24px; color: #fff; background: rgba(255,255,255,0.05); }
.slot.active { border-style: solid; background: rgba(255,215,0,0.2); box-shadow: 0 0 10px #f1c40f; color: #f1c40f; }
.han{ font-size:80px; margin:15px 0; color:#ffdf7f; text-shadow: 0 0 20px #ff4500; min-height: 100px;}
.info{ font-size:18px; color: #fff; margin-bottom: 10px;}
button{
  background: linear-gradient(#f1c40f, #d4ac0d);
  color:#4a1a1a; border:none; border-radius:8px;
  padding:12px 25px; font-size:18px; cursor:pointer; font-weight: bold;
}
button:disabled{ opacity:0.3; cursor:not-allowed; }
select { padding: 5px; font-size: 16px; background: #4a1a1a; color: #fff; border: 1px solid #f1c40f; }
.copyBox{ display:none; margin-top: 20px;}
textarea{ width:90%; height:100px; background: #000; color: #0f0; border: 1px solid #333; padding: 10px; }
</style>
</head>
<body>

<h1>üúÉ LI√äN HOA ƒê·ªòN üúÉ</h1>
<div style="color: #ffdf7f; margin-bottom: 10px;">V·∫†N V·∫¨T DUY T√ÇM T·∫†O - T·∫¨P TH·ªÇ KH·∫æ H·ª¢P NƒÇNG L∆Ø·ª¢NG</div>

<div class="setup-box">
    Ch·ªçn s·ªë ng∆∞·ªùi c√πng ƒê·ªông T√¢m: 
    <select id="memberCount">
        <option value="1">1 ng∆∞·ªùi (ƒê∆°n th√¢n)</option>
        <option value="2">2 ng∆∞·ªùi (Song h√†nh)</option>
        <option value="3">3 ng∆∞·ªùi (Tam t√†i)</option>
        <option value="4">4 ng∆∞·ªùi (T·ª© t∆∞·ª£ng)</option>
        <option value="5">5 ng∆∞·ªùi (Ng≈© h√†nh)</option>
        <option value="6" selected>6 ng∆∞·ªùi (L·ª•c h·ª£p)</option>
        <option value="7">7 ng∆∞·ªùi (Th·∫•t tinh)</option>
        <option value="8">8 ng∆∞·ªùi (B√°t qu√°i)</option>
        <option value="9">9 ng∆∞·ªùi (C·ª≠u cung)</option>
    </select>
    <button id="btnStart">B·∫Øt ƒê·∫ßu L·ªÖ Th·ªânh</button>
</div>

<div id="mainApp" style="display:none;">
    <div class="box">
        <div style="font-size: 1.5em; font-weight: bold;">PH·∫¶N I: TH·ªàNH QU·∫∫ TH∆Ø·ª¢NG</div>
        <div id="slotsThuong" class="energy-slots"></div>
        <div id="thuongChar" class="han">---</div>
        <div id="thuongInfo" class="info">M·ªùi ng∆∞·ªùi th·ª© 1 b·∫•m g√≥p t√¢m...</div>
        <button id="btnActionThuong">G√ìP T√ÇM NƒÇNG L∆Ø·ª¢NG</button>
    </div>

    <div class="box" id="boxHa" style="opacity: 0.3;">
        <div style="font-size: 1.5em; font-weight: bold;">PH·∫¶N II: TH·ªàNH QU·∫∫ H·∫†</div>
        <div id="slotsHa" class="energy-slots"></div>
        <div id="haChar" class="han">---</div>
        <div id="haInfo" class="info">Ch·ªù ho√†n t·∫•t Qu·∫ª Th∆∞·ª£ng...</div>
        <button id="btnActionHa" disabled>G√ìP T√ÇM NƒÇNG L∆Ø·ª¢NG</button>
    </div>
</div>

<div class="box copyBox" id="copyBox">
    <h3>K·∫æT QU·∫¢ TH·∫¶N √ù T·∫¨P TH·ªÇ</h3>
    <textarea id="resultText" readonly></textarea><br><br>
    <button onclick="location.reload()" style="background: #7a0000; color: white;">Th·ªânh Qu·∫ª M·ªõi</button>
</div>

<script>
// 8 N√©t c∆° b·∫£n (D√πng l√†m bi·ªÉu t∆∞·ª£ng nƒÉng l∆∞·ª£ng)
const NET_CO_BAN = ["‰∏∂", "‰∏Ä", "‰∏®", "‰∏ø", "‰πÄ", "„áÄ", "‚îê", "‰∫Ö"];
const NET_TEN = ["Ch·∫•m", "Ngang", "S·ªï", "Ph·∫©y", "M√°c", "H·∫•t", "G·∫≠p", "M√≥c"];

// (D·ªØ li·ªáu 500 ch·ªØ r√∫t g·ªçn ƒë·ªÉ minh h·ªça, b·∫°n h√£y copy to√†n b·ªô HAN_DATA t·ª´ file tr∆∞·ªõc v√†o ƒë√¢y)
const HAN_DATA = [
    {c:"‰πæ",v:"C√†n (Tr·ªùi)",n:11},{c:"Âù§",v:"Kh√¥n (ƒê·∫•t)",n:8},{c:"Èúá",v:"Ch·∫•n (S·∫•m)",n:15},{c:"Â∑Ω",v:"T·ªën (Gi√≥)",n:12},
    {c:"Âùé",v:"Kh·∫£m (N∆∞·ªõc)",n:7},{c:"Èõ¢",v:"Ly (L·ª≠a)",n:19},{c:"ËâÆ",v:"C·∫•n (N√∫i)",n:7},{c:"ÂÖå",v:"ƒêo√†i (ƒê·∫ßm)",n:7},
    {c:"Â§©",v:"Thi√™n (Tr·ªùi)",n:4},{c:"Âú∞",v:"ƒê·ªãa (ƒê·∫•t)",n:6},{c:"ÁéÑ",v:"Huy·ªÅn (S√¢u k√≠n)",n:5},{c:"ÈªÉ",v:"Ho√†ng (V√†ng)",n:12},
    {c:"Èæç",v:"Long (R·ªìng)",n:16},{c:"Â∏´",v:"S∆∞ (Th·∫ßy)",n:10},{c:"ÁÅ´",v:"H·ªèa (L·ª≠a)",n:4},{c:"Â∏ù",v:"ƒê·∫ø (Vua)",n:9}
    // ... Copy ti·∫øp 500 ch·ªØ c·ªßa t√¥i ƒë√£ g·ª≠i ·ªü tr√™n v√†o ƒë√¢y ...
];

let totalMembers = 6;
let currentThuong = 0;
let currentHa = 0;
let seedThuong = 0;
let seedHa = 0;

const btnStart = document.getElementById('btnStart');
const mainApp = document.getElementById('mainApp');
const memberSelect = document.getElementById('memberCount');

btnStart.onclick = () => {
    totalMembers = parseInt(memberSelect.value);
    document.querySelector('.setup-box').style.display = 'none';
    mainApp.style.display = 'block';
    createSlots('slotsThuong', totalMembers);
    createSlots('slotsHa', totalMembers);
};

function createSlots(id, count) {
    const container = document.getElementById(id);
    for(let i=0; i<count; i++) {
        let div = document.createElement('div');
        div.className = 'slot';
        div.id = id + '_' + i;
        div.innerText = '?';
        container.appendChild(div);
    }
}

// X·ª≠ l√Ω Th·ªânh Qu·∫ª Th∆∞·ª£ng
document.getElementById('btnActionThuong').onclick = async function() {
    if(currentThuong < totalMembers) {
        let randIndex = Math.floor(Math.random() * 8);
        seedThuong += randIndex + (new Date().getMilliseconds()); // T·∫°o h·∫°t gi·ªëng ng·∫´u nhi√™n c·ªông d·ªìn
        
        let slot = document.getElementById('slotsThuong_' + currentThuong);
        slot.innerText = NET_CO_BAN[randIndex];
        slot.className = 'slot active';
        
        currentThuong++;
        if(currentThuong < totalMembers) {
            document.getElementById('thuongInfo').innerText = `M·ªùi ng∆∞·ªùi th·ª© ${currentThuong + 1} ti·∫øp t·ª•c...`;
        } else {
            this.disabled = true;
            document.getElementById('thuongInfo').innerText = "NƒÉng l∆∞·ª£ng ƒë√£ ƒë·ªß. ƒêang k·∫øt tinh Th·∫ßn √ù...";
            await new Promise(r => setTimeout(r, 3000));
            
            // Ch·ªçn ch·ªØ d·ª±a tr√™n h·∫°t gi·ªëng t·ªïng h·ª£p
            let finalChar = HAN_DATA[seedThuong % HAN_DATA.length];
            document.getElementById('thuongChar').innerText = finalChar.c;
            document.getElementById('thuongInfo').innerText = `K·∫øt qu·∫£: ${finalChar.v} (${finalChar.n} n√©t)`;
            
            // M·ªü qu·∫ª h·∫°
            document.getElementById('boxHa').style.opacity = '1';
            document.getElementById('btnActionHa').disabled = false;
            document.getElementById('haInfo').innerText = "M·ªùi ng∆∞·ªùi th·ª© 1 b·∫Øt ƒë·∫ßu Th·ªânh Qu·∫ª H·∫°...";
        }
    }
};

// X·ª≠ l√Ω Th·ªânh Qu·∫ª H·∫° (T∆∞∆°ng t·ª±)
document.getElementById('btnActionHa').onclick = async function() {
    if(currentHa < totalMembers) {
        let randIndex = Math.floor(Math.random() * 8);
        seedHa += randIndex + (new Date().getMilliseconds());
        
        let slot = document.getElementById('slotsHa_' + currentHa);
        slot.innerText = NET_CO_BAN[randIndex];
        slot.className = 'slot active';
        
        currentHa++;
        if(currentHa < totalMembers) {
            document.getElementById('haInfo').innerText = `M·ªùi ng∆∞·ªùi th·ª© ${currentHa + 1} ti·∫øp t·ª•c...`;
        } else {
            this.disabled = true;
            document.getElementById('haInfo').innerText = "NƒÉng l∆∞·ª£ng ƒë√£ ƒë·ªß. ƒêang k·∫øt tinh Th·∫ßn √ù...";
            await new Promise(r => setTimeout(r, 3000));
            
            let finalChar = HAN_DATA[seedHa % HAN_DATA.length];
            document.getElementById('haChar').innerText = finalChar.c;
            document.getElementById('haInfo').innerText = `K·∫øt qu·∫£: ${finalChar.v} (${finalChar.n} n√©t)`;
            
            showFinal();
        }
    }
};

function showFinal() {
    const t = document.getElementById('thuongChar').innerText;
    const h = document.getElementById('haChar').innerText;
    document.getElementById('copyBox').style.display = 'block';
    document.getElementById('resultText').value = 
        `QU·∫∫ T·∫¨P TH·ªÇ (${totalMembers} ng∆∞·ªùi h·ª£p l·ª±c):\n` +
        `Th∆∞·ª£ng: ${t}\n` +
        `H·∫°: ${h}\n` +
        `Th·ªùi gian: ${new Date().toLocaleString('vi-VN')}`;
}
</script>
</body>
</html>
